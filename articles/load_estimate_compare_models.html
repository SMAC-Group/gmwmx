<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Load data, estimate and compare models â€¢ gmwmx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Load data, estimate and compare models">
<meta property="og:description" content="gmwmx">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gmwmx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/load_estimate_compare_models.html">Load data, estimate and compare models</a>
    </li>
    <li>
      <a href="../articles/simulate_data.html">Simulate data</a>
    </li>
    <li>
      <a href="../articles/remove_outliers_hector.html">Remove extreme values from signal with Hector</a>
    </li>
    <li>
      <a href="../articles/simulation_study.html">Simulation study: comparing the GMWMX-1, GMWMX-2 and MLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SMAC-Group" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Load data, estimate and compare models</h1>
            
      
      
      <div class="hidden name"><code>load_estimate_compare_models.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="importing-a--mom-file-as-a-gnssts-object">Importing a <code>.mom</code> file as a <code>gnssts</code> object<a class="anchor" aria-label="anchor" href="#importing-a--mom-file-as-a-gnssts-object"></a>
</h2>
<p>Let us first load the <code>gmwmx</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gmwmx</span><span class="op">)</span></span></code></pre></div>
<p>Consider that you want to estimate a model on data saved in a <code>.mom</code> file located at a specific <code>file_path</code> on your computer.</p>
<p>For example, the corresponding <code>.mom</code> file could have a similar looking:</p>
<pre><code><span><span class="co"># sampling period 1.000000</span></span>
<span><span class="co"># offset 55285.000000</span></span>
<span><span class="co"># offset 58287.770833</span></span>
<span><span class="fl">52759.5</span> <span class="op">-</span><span class="fl">0.01165</span></span>
<span><span class="fl">52760.5</span> <span class="op">-</span><span class="fl">0.01102</span></span>
<span><span class="fl">52761.5</span> <span class="op">-</span><span class="fl">0.01147</span></span>
<span><span class="va">...</span></span></code></pre>
<p>You can import the <code>.mom</code> file as a with the function <code><a href="../reference/read.gnssts.html">read.gnssts()</a></code> as such:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_dobs</span> <span class="op">=</span> <span class="fu"><a href="../reference/read.gnssts.html">read.gnssts</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="va">file_path</span><span class="op">)</span></span></code></pre></div>
<p>Objects created or imported with <code>create.gnss()</code> or <code><a href="../reference/read.gnssts.html">read.gnssts()</a></code> are of class <code>gnssts</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">data_dobs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "gnssts"</span></span></code></pre>
<p>By inspecting the structure of a <code>gnssts</code> object, we observe that <code>gnssts</code> objects specify the time vector, the observation vector, the sampling period and the times at which there are location shifts (jumps).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">data_dobs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 4</span></span>
<span><span class="co">##  $ t              : num [1:5559] 52760 52760 52762 52764 52766 ...</span></span>
<span><span class="co">##  $ y              : num [1:5559] -0.0117 -0.011 -0.0115 -0.0131 -0.0106 ...</span></span>
<span><span class="co">##  $ sampling_period: num 1</span></span>
<span><span class="co">##  $ jumps          : num [1:2] 55285 58288</span></span>
<span><span class="co">##  - attr(*, "class")= chr "gnssts"</span></span></code></pre>
<p>We can represent the signal as such:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_dobs</span><span class="op">$</span><span class="va">t</span>, <span class="va">data_dobs</span><span class="op">$</span><span class="va">y</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="load_estimate_compare_models_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="estimate-a-model">Estimate a model<a class="anchor" aria-label="anchor" href="#estimate-a-model"></a>
</h2>
<div class="section level3">
<h3 id="supported-models">Supported models<a class="anchor" aria-label="anchor" href="#supported-models"></a>
</h3>
<p>The <code>gmwmx</code> package allows to estimate linear model with correlated residuals that are described by a functional model and a stochastic noise model.</p>
<div class="section level4">
<h4 id="functional-model">Functional model<a class="anchor" aria-label="anchor" href="#functional-model"></a>
</h4>
<p>More precisely, for the functional model, we consider a linear model which can be expressed as:</p>
<p><span class="math display">\[\begin{equation}
    \mathbf{Y} = \mathbf{A} {{\bf x}}_0 + \boldsymbol{\varepsilon},

\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathbf{Y} \in {\rm I\!R}^n\)</span> denotes the response variable of interest (i.e., vector of GNSS observations), <span class="math inline">\(\mathbf{A} \in {\rm I\!R}^{n \times p}\)</span> a fixed design matrix, <span class="math inline">\({{\bf x}}_0 \in \mathcal{X} \subset {\rm I\!R}^p\)</span> a vector of unknown constants and <span class="math inline">\(\boldsymbol{\varepsilon} \in {\rm I\!R}^n\)</span> a vector of (zero mean) residuals.</p>
<p>The <code>gmwmx</code> package allows to estimate functional models for which the <span class="math inline">\(i\)</span>-th component of the vector <span class="math inline">\(\mathbf{A} {{\bf x}}_0\)</span> can be described as follows:</p>
<p><span class="math display">\[\begin{equation}
    \mathbb{E}[\mathbf{Y}_i] = \mathbf{A}_i^T {{\bf x}}_0 = a+b\left(t_{i}-t_{0}\right)+\sum_{h=1}^{2}\left[c_{h} \sin \left(2 \pi f_{h} t_{i}\right)+d_{h} \cos \left(2 \pi f_{h} t_{i}\right)\right] + \sum_{k=1}^{n_{g}} g_{k} H\left(t_{i}-t_{k}\right),
\end{equation}\]</span></p>
<p>where <span class="math inline">\(a\)</span> is the initial position at the reference epoch <span class="math inline">\(t_0\)</span>, <span class="math inline">\(b\)</span> is the velocity parameter, <span class="math inline">\(c_k\)</span> and <span class="math inline">\(d_k\)</span> are the periodic motion parameters (<span class="math inline">\(h = 1\)</span> and <span class="math inline">\(h = 2\)</span> represent the annual and semi-annual seasonal terms, respectively). The offset terms models earthquakes, equipment changes or human intervention in which <span class="math inline">\(g_k\)</span> is the magnitude of the change at epochs <span class="math inline">\(t_k\)</span>, <span class="math inline">\(n_g\)</span> is the total number of offsets, and <span class="math inline">\(H\)</span> is the Heaviside step function.</p>
</div>
<div class="section level4">
<h4 id="stochastic-model">Stochastic model<a class="anchor" aria-label="anchor" href="#stochastic-model"></a>
</h4>
<p>Regarding the stochastic model, we assume that <span class="math inline">\(\boldsymbol{\varepsilon}_i=\mathbf{Y}_i-\mathbb{E}[\mathbf{Y}_i]\)</span> is a strictly (intrinsically) stationary process and that</p>
<p><span class="math display">\[\begin{equation}
    \boldsymbol{\varepsilon} \sim \mathcal{F} \left\{\mathbf{0}, \boldsymbol{\Sigma}(\boldsymbol{\gamma}_0)\right\} ,
    \label{eq:model:noise}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathcal{F}\)</span> denotes some probability distribution in <span class="math inline">\({\rm I\!R}^n\)</span> with mean <span class="math inline">\({\bf 0}\)</span> and covariance <span class="math inline">\(\boldsymbol{\Sigma}(\boldsymbol{\gamma}_0)\)</span>.</p>
<p>We assume that <span class="math inline">\(\boldsymbol{\Sigma}(\boldsymbol{\gamma}_0) &gt; 0\)</span> and that it depends on the unknown parameter vector <span class="math inline">\(\boldsymbol{\gamma}_0 \in \boldsymbol{\Gamma} \subset {\rm I\!R}^q\)</span>. This parameter vector specifies the covariance of the observations and is often referred to as the stochastic parameters.</p>
<p>Hence, we let <span class="math inline">\(\boldsymbol{\theta}_0 = \left[\boldsymbol{{\bf x}}_0^{\rm T} \;\; \boldsymbol{\gamma}_0^{\rm T}\right]^{\rm T} \in \boldsymbol{\Theta} = \mathcal{X} \times \boldsymbol{\Gamma} \subset {\rm I\!R}^{p + k}\)</span> denote the unknown parameter vector of the model described above.</p>
<p>The <code>gmwmx</code> allows to estimate parameters of a specified functional model as well as parameters of a stochastic model (i.e.Â <span class="math inline">\(\hat{\boldsymbol{\theta}} = \left[\boldsymbol{\hat{\boldsymbol{x}}}^{T} \;\; \hat{\boldsymbol{\gamma}}^{T}\right]\)</span>) defined by a combinations of</p>
<ol style="list-style-type: decimal">
<li>White noise (<code>wn</code>)</li>
<li>MatÃ¨rn process (<code>matern</code>)</li>
<li>Fractional Gaussian noise (<code>fgn</code>) and</li>
<li>Power Law process (<code>powerlaw</code>).</li>
</ol>
</div>
</div>
<div class="section level3">
<h3 id="estimate-a-model-with-the-gmwmx">Estimate a model with the GMWMX<a class="anchor" aria-label="anchor" href="#estimate-a-model-with-the-gmwmx"></a>
</h3>
<p>You can estimate a model using the GMWMX estimator with the function <code><a href="../reference/estimate_gmwmx.html">estimate_gmwmx()</a></code>.</p>
<p>The stochastic model considered is specified by a string provided to the argument <code>model_string</code> which is a combination of the strings <code>wn</code>, <code>powerlaw</code>, <code>matern</code> and <code>fgn</code> separated by the character <code>+</code>.</p>
<p>You specify the initialization values for solving the optimization problem at the GMWM estimation step that estimate the stochastic model by providing a numeric vector of the correct length (the total number of parameters of the stochastic model specified in <code>model_string</code>) to the argument <code>theta_0</code>.</p>
<p>You can compute confidence intervals for estimated functional parameters of an estimated model by setting the argument <code>ci</code> to <code>TRUE</code>.</p>
<p>Let us consider a single sinusoidal signal with the jumps specified in the <code>gnssts</code> object and a combination of a White noise and a Power Law process for the stochastic model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_dobs_wn_plp_gmwmx</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_gmwmx.html">estimate_gmwmx</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data_dobs</span>, theta_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, </span>
<span>                                       model_string <span class="op">=</span> <span class="st">"wn+powerlaw"</span>, </span>
<span>                                       n_seasonal <span class="op">=</span> <span class="fl">1</span>, ci <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>Estimated models are of class <code>gnsstsmodel</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit_dobs_wn_plp_gmwmx</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "gnsstsmodel"</span></span></code></pre>
<p>We can print the estimated model or extract estimated parameters (functional and stochastic) as such:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_dobs_wn_plp_gmwmx</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## GNSS time series model</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  * Model:  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  * Functional parameters:</span></span>
<span><span class="co">##      bias                           :     +0.01201297 +/- 0.020</span></span>
<span><span class="co">##      trend                          :     +0.00000835 +/- 0.000</span></span>
<span><span class="co">##      A*cos(U)                       :     -0.00065540 +/- 0.000</span></span>
<span><span class="co">##      A*sin(U)                       :     +0.00001579 +/- 0.000</span></span>
<span><span class="co">##      jump                           :     -0.00375807 +/- 0.001</span></span>
<span><span class="co">##      jump                           :     +0.00156788 +/- 0.001</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  * Stochastc parameters:</span></span>
<span><span class="co">##      wn_sigma2                      :     +0.00000079</span></span>
<span><span class="co">##      powerlaw_sigma2                :     +0.00000025</span></span>
<span><span class="co">##      powerlaw_d                     :     +0.49990000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  * Estimation time: 1.54 s</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_dobs_wn_plp_gmwmx</span><span class="op">$</span><span class="va">beta_hat</span></span></code></pre></div>
<pre><code><span><span class="co">##          bias         trend      A*cos(U)      A*sin(U)          jump </span></span>
<span><span class="co">##  1.201297e-02  8.351512e-06 -6.553985e-04  1.578605e-05 -3.758074e-03 </span></span>
<span><span class="co">##          jump </span></span>
<span><span class="co">##  1.567881e-03</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_dobs_wn_plp_gmwmx</span><span class="op">$</span><span class="va">theta_hat</span></span></code></pre></div>
<pre><code><span><span class="co">##       wn_sigma2 powerlaw_sigma2      powerlaw_d </span></span>
<span><span class="co">##    7.916985e-07    2.525867e-07    4.999000e-01</span></span></code></pre>
<p>We can also plot graphically the estimated functional model on the time series and the Wavelet variance of residuals by calling the <code>plot.gnsstsmodel</code> method on a <code>gnsstsmodel</code> object.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_dobs_wn_plp_gmwmx</span><span class="op">)</span></span></code></pre></div>
<p><img src="load_estimate_compare_models_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We can specify the number of iterations of the GMWMX to compute respectively the GMWMX-1 and GMWMX-2 or other iteration of the GMWMX with the argument <code>k_iter</code>. For example we can compute the GMWMX-2 as such:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_dobs_wn_plp_gmwmx_2</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_gmwmx.html">estimate_gmwmx</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data_dobs</span>, theta_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, model_string <span class="op">=</span> <span class="st">"wn+powerlaw"</span>, n_seasonal <span class="op">=</span> <span class="fl">1</span>, k_iter <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimate-a-model-with-the-mle-implemented-in-hector">Estimate a model with the MLE implemented in Hector<a class="anchor" aria-label="anchor" href="#estimate-a-model-with-the-mle-implemented-in-hector"></a>
</h3>
<p>Assuming that you have Hector available on the <code>PATH</code>, an estimation of the model can the be performed using the Maximum Likelihood Estimation (MLE) method implemented in <a href="http://segal.ubi.pt/hector/" class="external-link">Hector</a> as such:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_dobs_wn_plp_mle</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_hector.html">estimate_hector</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data_dobs</span>, </span>
<span>                                      model_string <span class="op">=</span> <span class="st">"wn+powerlaw"</span>, </span>
<span>                                      n_seasonal <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Similarly we can plot and extract the model parameters of the estimated model:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_dobs_wn_plp_mle</span><span class="op">)</span></span></code></pre></div>
<p><img src="load_estimate_compare_models_files/figure-html/unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_dobs_wn_plp_mle</span><span class="op">$</span><span class="va">beta_hat</span></span></code></pre></div>
<pre><code><span><span class="co">##          bias         trend      A*cos(U)      A*sin(U)          jump </span></span>
<span><span class="co">##  1.200000e-02  8.451006e-06 -6.672690e-04  1.359080e-06 -4.194170e-03 </span></span>
<span><span class="co">##          jump </span></span>
<span><span class="co">##  9.071300e-04</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_dobs_wn_plp_mle</span><span class="op">$</span><span class="va">theta_hat</span></span></code></pre></div>
<pre><code><span><span class="co">##       wn_sigma2 powerlaw_sigma2      powerlaw_d </span></span>
<span><span class="co">##    7.779727e-07    2.700504e-07    4.854970e-01</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="importing-data-from-the-plate-boundary-observatory-pbo">Importing data from the Plate Boundary Observatory (PBO)<a class="anchor" aria-label="anchor" href="#importing-data-from-the-plate-boundary-observatory-pbo"></a>
</h2>
<p>We can load time series data from the <a href="https://www.unavco.org/projects/past-projects/pbo/pbo.html" class="external-link">Plate Boundary Observatory (PBO)</a> as <code>gnssts</code> object with <code><a href="../reference/PBO_get_station.html">PBO_get_station()</a></code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cola</span> <span class="op">=</span> <span class="fu"><a href="../reference/PBO_get_station.html">PBO_get_station</a></span><span class="op">(</span><span class="st">"COLA"</span>, column <span class="op">=</span> <span class="st">"dE"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparing-estimated-models">Comparing estimated models<a class="anchor" aria-label="anchor" href="#comparing-estimated-models"></a>
</h2>
<p>Let us consider three potential models for the stochastic model of this signal. More precisely let us consider:</p>
<ul>
<li>a White noise and a PowerLaw process</li>
<li>a White noise coupled with a MatÃ¨rn process</li>
<li>a White noise and a Fractional Gaussian noise</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cola_wn_plp</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_gmwmx.html">estimate_gmwmx</a></span><span class="op">(</span><span class="va">cola</span>, model_string <span class="op">=</span> <span class="st">"wn+powerlaw"</span>, </span>
<span>                                 theta_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                                 n_seasonal <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                 ci <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_cola_wn_plp</span><span class="op">)</span></span></code></pre></div>
<p><img src="load_estimate_compare_models_files/figure-html/unnamed-chunk-19-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cola_wn_fgn</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_gmwmx.html">estimate_gmwmx</a></span><span class="op">(</span><span class="va">cola</span>, model_string <span class="op">=</span> <span class="st">"wn+fgn"</span>, theta_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span><span class="op">)</span>,</span>
<span>                                                          n_seasonal <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                                          ci <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_cola_wn_fgn</span><span class="op">)</span></span></code></pre></div>
<p><img src="load_estimate_compare_models_files/figure-html/unnamed-chunk-19-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cola_wn_matern</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_gmwmx.html">estimate_gmwmx</a></span><span class="op">(</span><span class="va">cola</span>, model_string <span class="op">=</span> <span class="st">"wn+matern"</span>, </span>
<span>                                    theta_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                                                          n_seasonal <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                                          ci <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_cola_wn_matern</span><span class="op">)</span></span></code></pre></div>
<p><img src="load_estimate_compare_models_files/figure-html/unnamed-chunk-19-3.png" width="576" style="display: block; margin: auto;"></p>
<p>You can compare estimated models with the function <code><a href="../reference/compare_fits.html">compare_fits()</a></code></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compare_fits.html">compare_fits</a></span><span class="op">(</span><span class="va">fit_cola_wn_plp</span>, <span class="va">fit_cola_wn_matern</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in compare_fits(fit_cola_wn_plp, fit_cola_wn_matern): Provided fits do</span></span>
<span><span class="co">## not esimate the same model.</span></span></code></pre>
<p><img src="load_estimate_compare_models_files/figure-html/unnamed-chunk-20-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Davide Antonio Cucci, Lionel Voirol, StÃ©phane Guerrier.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
