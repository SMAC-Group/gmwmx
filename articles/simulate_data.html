<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generate data from a model • gmwmx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generate data from a model">
<meta property="og:description" content="gmwmx">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gmwmx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/load_estimate_compare_models.html">Load data, estimate and compare models</a>
    </li>
    <li>
      <a href="../articles/simulate_data.html">Simulate data</a>
    </li>
    <li>
      <a href="../articles/remove_outliers_hector.html">Remove extreme values from signal with Hector</a>
    </li>
    <li>
      <a href="../articles/simulation_study.html">Simulation study: comparing the GMWMX-1, GMWMX-2 and MLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SMAC-Group/gmwmx" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generate data from a model</h1>
            
      
      
      <div class="hidden name"><code>simulate_data.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SMAC-Group/simts" class="external-link">simts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gmwmx</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phase</span> <span class="op">=</span>     <span class="fl">0.45</span></span>
<span><span class="va">amplitude</span> <span class="op">=</span> <span class="fl">2.5</span></span>
<span><span class="va">sigma2_wn</span> <span class="op">=</span>       <span class="fl">15</span></span>
<span><span class="va">sigma2_powerlaw</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">d</span> <span class="op">=</span>               <span class="fl">0.4</span></span>
<span><span class="va">bias</span> <span class="op">=</span>            <span class="fl">0</span></span>
<span><span class="va">trend</span> <span class="op">=</span>           <span class="fl">5</span><span class="op">/</span><span class="fl">365.25</span></span>
<span><span class="va">cosU</span> <span class="op">=</span>            <span class="va">amplitude</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">phase</span><span class="op">)</span></span>
<span><span class="va">sinU</span> <span class="op">=</span>            <span class="va">amplitude</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">phase</span><span class="op">)</span></span></code></pre></div>
<p>Let us consider a period of 5 year with daily observations:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">5</span><span class="op">*</span><span class="fl">365</span></span></code></pre></div>
<p>Using functions implemented in <code>simts</code>, we generate
realizations from the sum of a White noise and PowerLaw process.</p>
<p>Note that the functions that enable to generate stochastic models
that include Power Law process, Matèrn process or Fractional Gaussian
noise are (for now) only available from the development version of the
package <code>simts</code> that can be easily installed with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"SMAC-Group/simts"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_i</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/simts/man/WN.html" class="external-link">WN</a></span><span class="op">(</span>sigma2 <span class="op">=</span> <span class="va">sigma2_wn</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/simts/man/PLP.html" class="external-link">PLP</a></span><span class="op">(</span>sigma2 <span class="op">=</span> <span class="va">sigma2_powerlaw</span>, d <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define time at which there are jumps</span></span>
<span><span class="va">jump_vec</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">1200</span><span class="op">)</span></span>
<span><span class="va">jump_height</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define myseed</span></span>
<span><span class="va">myseed</span><span class="op">=</span><span class="fl">123</span></span></code></pre></div>
<p>We generate residuals from the stochastic model</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate residuals</span></span>
<span><span class="va">eps</span> <span class="op">=</span> <span class="fu">simts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/simts/man/gen_gts.html" class="external-link">gen_gts</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_i</span>, n<span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></code></pre></div>
<p>Using function <code><a href="../reference/create_A_matrix.html">create_A_matrix()</a></code>, we encode the
intercept, a deterministic vector (trend) and sinusoidal signals in a
matrix <span class="math inline">\(\boldsymbol{A}\)</span> in order to
compute the deterministic component of the signal in a linear fashion.
Similarly, we define the vector of fixed coefficients denoted by <span class="math inline">\(\boldsymbol{x}_0\)</span> in the paper.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add trend and sin</span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu">gmwmx</span><span class="fu">::</span><span class="fu"><a href="../reference/create_A_matrix.html">create_A_matrix</a></span><span class="op">(</span>t_nogap <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span>, n_seasonal <span class="op">=</span>  <span class="fl">1</span>, jumps <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define beta</span></span>
<span><span class="va">x_0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bias</span>, <span class="va">trend</span>,  <span class="va">cosU</span>,  <span class="va">sinU</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># create time series</span></span>
<span><span class="va">deterministic_signal</span> <span class="op">=</span> <span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x_0</span></span></code></pre></div>
<p>We can graphically represent the functional and stochastic component
of the model as follows</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">deterministic_signal</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate_data_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate_data_files/figure-html/unnamed-chunk-11-2.png" width="576" style="display: block; margin: auto;"></p>
<p>We can add location shifts (jumps) in the signal as such:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add trend, gaps and sin</span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu">gmwmx</span><span class="fu">::</span><span class="fu"><a href="../reference/create_A_matrix.html">create_A_matrix</a></span><span class="op">(</span>t_nogap <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span>, n_seasonal <span class="op">=</span>  <span class="fl">1</span>, jumps <span class="op">=</span> <span class="va">jump_vec</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define beta</span></span>
<span><span class="va">x_0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bias</span>, <span class="va">trend</span>,  <span class="va">cosU</span>,  <span class="va">sinU</span>, <span class="va">jump_height</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># create time series</span></span>
<span><span class="va">deterministic_signal</span> <span class="op">=</span> <span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x_0</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">deterministic_signal</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate_data_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate_data_files/figure-html/unnamed-chunk-13-2.png" width="576" style="display: block; margin: auto;"></p>
<p>We can then define and plot the generated time series</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yy</span> <span class="op">=</span> <span class="va">deterministic_signal</span> <span class="op">+</span> <span class="va">eps</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">yy</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate_data_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We define a <code>gnssts</code> object.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save signal in temp</span></span>
<span><span class="va">gnssts_obj</span> <span class="op">=</span> <span class="fu"><a href="../reference/create.gnssts.html">create.gnssts</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">yy</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">yy</span>, jumps <span class="op">=</span> <span class="va">jump_vec</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">gnssts_obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "gnssts"</span></span></code></pre></div>
<p>We can save a <code>gnssts</code> object as a <code>.mom</code> file
with the function <code><a href="../reference/write.gnssts.html">write.gnssts()</a></code></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write.gnssts.html">write.gnssts</a></span><span class="op">(</span><span class="va">gnssts_obj</span>, filename <span class="op">=</span> <span class="st">"simulated_data.mom"</span><span class="op">)</span></span></code></pre></div>
<p>The saved <code>.mom</code> file will have the following
structure:</p>
<pre><code># sampling period 1.000000
# offset 100.000000
# offset 200.000000
1 9.89397119231205
2 8.52434609242207
3 9.32563441388655
4 13.4598690226589
5 8.21468271071893
6 -1.62924569468478
7 17.8036063408026
8 7.13794134326489
9 5.34700832531847</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_gmwmx</span> <span class="op">=</span> <span class="fu">gmwmx</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_gmwmx.html">estimate_gmwmx</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gnssts_obj</span>,</span>
<span>                                  model_string <span class="op">=</span> <span class="st">"wn+powerlaw"</span>,</span>
<span>                                  n_seasonal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                  theta_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                                  k_iter <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_gmwmx</span></span>
<span><span class="co">#&gt; GNSS time series model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Model: wn + powerlaw </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Functional parameters:</span></span>
<span><span class="co">#&gt;      bias            :  +0.778520</span></span>
<span><span class="co">#&gt;      trend           :  +0.015804</span></span>
<span><span class="co">#&gt;      A*cos(U)        :  +2.366464</span></span>
<span><span class="co">#&gt;      A*sin(U)        :  +1.958204</span></span>
<span><span class="co">#&gt;      jump            : +20.061620</span></span>
<span><span class="co">#&gt;      jump            : +30.596085</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Stochastic parameters:</span></span>
<span><span class="co">#&gt;      wn_sigma2                      :    +11.80775096</span></span>
<span><span class="co">#&gt;      powerlaw_sigma2                :    +11.93347935</span></span>
<span><span class="co">#&gt;      powerlaw_d                     :     +0.34017417</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Estimation time: 0.21 s</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_gmwmx</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate_data_files/figure-html/unnamed-chunk-18-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_gmwmx_2</span> <span class="op">=</span> <span class="fu">gmwmx</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_gmwmx.html">estimate_gmwmx</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gnssts_obj</span>,</span>
<span>                                    model_string <span class="op">=</span> <span class="st">"wn+powerlaw"</span>,</span>
<span>                                    n_seasonal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                    theta_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                                    k_iter <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_gmwmx_2</span></span>
<span><span class="co">#&gt; GNSS time series model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Model: wn + powerlaw </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Functional parameters:</span></span>
<span><span class="co">#&gt;      bias            :  +0.891683</span></span>
<span><span class="co">#&gt;      trend           :  +0.016483</span></span>
<span><span class="co">#&gt;      A*cos(U)        :  +2.438139</span></span>
<span><span class="co">#&gt;      A*sin(U)        :  +2.043069</span></span>
<span><span class="co">#&gt;      jump            : +19.550541</span></span>
<span><span class="co">#&gt;      jump            : +30.869573</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Stochastic parameters:</span></span>
<span><span class="co">#&gt;      wn_sigma2                      :    +11.96947053</span></span>
<span><span class="co">#&gt;      powerlaw_sigma2                :    +11.75061286</span></span>
<span><span class="co">#&gt;      powerlaw_d                     :     +0.34298983</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Estimation time: 0.53 s</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_gmwmx_2</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate_data_files/figure-html/unnamed-chunk-19-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_mle_hector</span> <span class="op">=</span> <span class="fu">gmwmx</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_hector.html">estimate_hector</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gnssts_obj</span>,</span>
<span>                                    model_string <span class="op">=</span> <span class="st">"wn+powerlaw"</span>,</span>
<span>                                    n_seasonal <span class="op">=</span> <span class="fl">1</span></span>
<span>                                    <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_mle_hector</span></span>
<span><span class="co">#&gt; GNSS time series model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Model: wn + powerlaw </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Functional parameters:</span></span>
<span><span class="co">#&gt;      bias            :  -0.889000 +/- 1.5900000000</span></span>
<span><span class="co">#&gt;      trend           :  +0.015639 +/- 0.0019873265</span></span>
<span><span class="co">#&gt;      A*cos(U)        :  +2.542700 +/- 0.4870740000</span></span>
<span><span class="co">#&gt;      A*sin(U)        :  +0.966218 +/- 0.4826000000</span></span>
<span><span class="co">#&gt;      jump            : +18.008400 +/- 1.5199300000</span></span>
<span><span class="co">#&gt;      jump            : +30.626100 +/- 1.5310600000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Stochastic parameters:</span></span>
<span><span class="co">#&gt;      wn_sigma2                      :     +9.10561714</span></span>
<span><span class="co">#&gt;      powerlaw_sigma2                :    +17.73165228</span></span>
<span><span class="co">#&gt;      powerlaw_d                     :     +0.29703100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  * Estimation time: 20.17 s</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_mle_hector</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate_data_files/figure-html/unnamed-chunk-23-1.png" width="576" style="display: block; margin: auto;"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Davide Antonio Cucci, Lionel Voirol, Stéphane Guerrier.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
