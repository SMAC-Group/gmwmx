<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation study • gmwmx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulation study">
<meta property="og:description" content="gmwmx">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gmwmx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/load_estimate_compare_models.html">Load data, estimate and compare models</a>
    </li>
    <li>
      <a href="../articles/simulate_data.html">Simulate data</a>
    </li>
    <li>
      <a href="../articles/remove_outliers_hector.html">Remove extreme values from signal with Hector</a>
    </li>
    <li>
      <a href="../articles/simulation_study.html">Simulation study: comparing the GMWMX-1, GMWMX-2 and MLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SMAC-Group/gmwmx" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simulation study</h1>
            
      
      
      <div class="hidden name"><code>simulation_study.Rmd</code></div>

    </div>

    
    
<p>This vignette reproduce a design considered in <a href="https://arxiv.org/abs/2206.09668" class="external-link">Cucci et al. (2022)</a> and
implement a Monte Carlo simulation comparing the performance of the
GMWMX-1, the GMWMX-2 and the MLE implemented in <a href="https://teromovigo.com/hector/" class="external-link">Hector</a>. Note that this file is
not intended to be run on a personal computer but should rather be
executed on a high performance computing cluster.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SMAC-Group/simts" class="external-link">simts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gmwmx</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">check_if_theta_in_ci</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta_vec</span>, <span class="va">ci_mat</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">vec_emp_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"logical"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta_vec</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta_vec</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">theta_vec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">ci_mat</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">ci_mat</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">vec_emp_coverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">T</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">vec_emp_coverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">F</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">vec_emp_coverage</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we consider example the model considered in model 3</span></span>
<span><span class="va">phase</span> <span class="op">&lt;-</span> <span class="fl">0.45</span></span>
<span><span class="va">amplitude</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">sigma2_wn</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="va">sigma2_powerlaw</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">0.4</span></span>
<span><span class="va">bias</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">trend</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="op">/</span> <span class="fl">365.25</span></span>
<span><span class="va">cosU</span> <span class="op">&lt;-</span> <span class="va">amplitude</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">phase</span><span class="op">)</span></span>
<span><span class="va">sinU</span> <span class="op">&lt;-</span> <span class="va">amplitude</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">phase</span><span class="op">)</span></span></code></pre></div>
<p>Let us consider 5 years of daily data</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># consider n years of daily observations</span></span>
<span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">year</span> <span class="op">*</span> <span class="fl">365</span></span></code></pre></div>
<p>We consider a gaussian White noise and a Power Law process as the
stochastic model of the residuals <span class="math inline">\(\varepsilon\)</span>.</p>
<p>Note that the functions that enable to generate stochastic models
that include Power Law process, Matèrn process or Fractional Gaussian
noise are (for now) only available from the development version of the
package <code>simts</code> that can be easily installed with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"SMAC-Group/simts"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define model for generating gaussian white noise + PLP</span></span>
<span><span class="va">model_gaussian_wn_plp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simts/man/WN.html" class="external-link">WN</a></span><span class="op">(</span>sigma2 <span class="op">=</span> <span class="va">sigma2_wn</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/simts/man/PLP.html" class="external-link">PLP</a></span><span class="op">(</span>sigma2 <span class="op">=</span> <span class="va">sigma2_powerlaw</span>, d <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span></code></pre></div>
<p>We consider three location shifts (jumps) at three different
heights.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate data</span></span>
<span><span class="co"># define time at which there are jumps</span></span>
<span><span class="va">jump_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">300</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">jump_height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p>We define a seed for reproducibility</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define seed</span></span>
<span><span class="va">myseed</span> <span class="op">&lt;-</span> <span class="fl">123</span></span>
<span></span>
<span><span class="co"># add trend, gaps and sin</span></span>
<span><span class="va">nbr_sin</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># define number of sinusoidal process</span></span></code></pre></div>
<p>and create the matrix <span class="math inline">\(\boldsymbol{A}\)</span> with function
<code><a href="../reference/create_A_matrix.html">create_A_matrix()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define A matrix</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_A_matrix.html">create_A_matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">jump_vec</span>, n_seasonal <span class="op">=</span> <span class="va">nbr_sin</span><span class="op">)</span></span></code></pre></div>
<p>We set the vector of functional parameters <span class="math inline">\(\boldsymbol{x}_0\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define beta</span></span>
<span><span class="va">x_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bias</span>, <span class="va">trend</span>, <span class="va">cosU</span>, <span class="va">sinU</span>, <span class="va">jump_height</span><span class="op">)</span></span></code></pre></div>
<p>We define the number of simulations to perform</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define number of Monte Carlo simulation</span></span>
<span><span class="va">n_simu</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># define number of parameter estimated (depends on the model)</span></span>
<span><span class="co"># bias + trend + height * nbr of jump vec + 2* nbr of sin process + wn + powerlaw parameters</span></span>
<span><span class="va">nbr_param_check_coverage</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">nbr_param</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">jump_vec</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">nbr_sin</span> <span class="op">+</span> <span class="fl">3</span></span>
<span><span class="va">dim_mat_results</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">nbr_param</span> <span class="op">+</span> <span class="va">nbr_param_check_coverage</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="fl">3</span></span>
<span></span>
<span><span class="co"># define matrix of results</span></span>
<span><span class="va">mat_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, ncol <span class="op">=</span> <span class="va">dim_mat_results</span>, nrow <span class="op">=</span> <span class="va">n_simu</span><span class="op">)</span></span></code></pre></div>
<p>We perform the simulation, saving for each Monte Carlo run, the
estimated parameters of the functional and stochastic model and the
empirical coverage on the functional parameters for the GMWMX-1, the
GMWMX-2 as well as the MLE implemented in <a href="https://teromovigo.com/hector/" class="external-link">Hector</a>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">simu_b</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">n_simu</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># fix seed for reproducibility</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">myseed</span> <span class="op">+</span> <span class="va">simu_b</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># generate residuals from a Gaussian White noise + Power law process</span></span>
<span>  <span class="va">eps</span> <span class="op">&lt;-</span> <span class="fu">simts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/simts/man/gen_gts.html" class="external-link">gen_gts</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_gaussian_wn_plp</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># create time series</span></span>
<span>  <span class="va">yy</span> <span class="op">&lt;-</span> <span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x_0</span> <span class="op">+</span> <span class="va">eps</span></span>
<span></span>
<span>  <span class="co"># create gnssts</span></span>
<span>  <span class="va">gnssts_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.gnssts.html">create.gnssts</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">yy</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">yy</span>, jumps <span class="op">=</span> <span class="va">jump_vec</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># MLE</span></span>
<span>  <span class="va">fit_simu_b_mle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_hector.html">estimate_hector</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">gnssts_obj</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"wn+powerlaw"</span>,</span>
<span>    n_seasonal <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># gmwmx 1 step</span></span>
<span>  <span class="va">fit_simu_b_gmwm_1_step</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_gmwmx.html">estimate_gmwmx</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">gnssts_obj</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"wn+powerlaw"</span>,</span>
<span>    theta_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    n_seasonal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    ci <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    k_iter <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># gmwmx 2 steps</span></span>
<span>  <span class="va">fit_simu_b_gmwm_2_step</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_gmwmx.html">estimate_gmwmx</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">gnssts_obj</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"wn+powerlaw"</span>,</span>
<span>    theta_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    n_seasonal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    ci <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    k_iter <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="co"># define vector of estimators</span></span>
<span>  <span class="va">fit_mle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_simu_b_mle</span><span class="op">$</span><span class="va">beta_hat</span>, <span class="va">fit_simu_b_mle</span><span class="op">$</span><span class="va">theta_hat</span><span class="op">)</span></span>
<span>  <span class="va">fit_gmwm_1_step</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_simu_b_gmwm_1_step</span><span class="op">$</span><span class="va">beta_hat</span>, <span class="va">fit_simu_b_gmwm_1_step</span><span class="op">$</span><span class="va">theta_hat</span><span class="op">)</span></span>
<span>  <span class="va">fit_gmwm_2_step</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_simu_b_gmwm_2_step</span><span class="op">$</span><span class="va">beta_hat</span>, <span class="va">fit_simu_b_gmwm_2_step</span><span class="op">$</span><span class="va">theta_hat</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># compute coverage for each method</span></span>
<span>  <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">.05</span></span>
<span>  <span class="va">z_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">mat_ci_mle_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">fit_simu_b_mle</span><span class="op">$</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">z_val</span> <span class="op">*</span> <span class="va">fit_simu_b_mle</span><span class="op">$</span><span class="va">beta_std</span>,</span>
<span>    <span class="va">fit_simu_b_mle</span><span class="op">$</span><span class="va">beta_hat</span> <span class="op">+</span> <span class="va">z_val</span> <span class="op">*</span> <span class="va">fit_simu_b_mle</span><span class="op">$</span><span class="va">beta_std</span></span>
<span>  <span class="op">)</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">F</span>, ncol <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">mat_ci_gmwm_1_step_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">fit_simu_b_gmwm_1_step</span><span class="op">$</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">z_val</span> <span class="op">*</span> <span class="va">fit_simu_b_gmwm_1_step</span><span class="op">$</span><span class="va">beta_std</span>,</span>
<span>    <span class="va">fit_simu_b_gmwm_1_step</span><span class="op">$</span><span class="va">beta_hat</span> <span class="op">+</span> <span class="va">z_val</span> <span class="op">*</span> <span class="va">fit_simu_b_gmwm_1_step</span><span class="op">$</span><span class="va">beta_std</span></span>
<span>  <span class="op">)</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">F</span>, ncol <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">mat_ci_gmwm_2_step_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">fit_simu_b_gmwm_2_step</span><span class="op">$</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">z_val</span> <span class="op">*</span> <span class="va">fit_simu_b_gmwm_2_step</span><span class="op">$</span><span class="va">beta_std</span>,</span>
<span>    <span class="va">fit_simu_b_gmwm_2_step</span><span class="op">$</span><span class="va">beta_hat</span> <span class="op">+</span> <span class="va">z_val</span> <span class="op">*</span> <span class="va">fit_simu_b_gmwm_2_step</span><span class="op">$</span><span class="va">beta_std</span></span>
<span>  <span class="op">)</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">F</span>, ncol <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># save empirical coverage</span></span>
<span>  <span class="va">inside_ci_mle</span> <span class="op">&lt;-</span> <span class="fu">check_if_theta_in_ci</span><span class="op">(</span><span class="va">x_0</span>, <span class="va">mat_ci_mle_beta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span>  <span class="va">inside_ci_gmwm_1</span> <span class="op">&lt;-</span> <span class="fu">check_if_theta_in_ci</span><span class="op">(</span><span class="va">x_0</span>, <span class="va">mat_ci_gmwm_1_step_beta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span>  <span class="va">inside_ci_gmwm_2</span> <span class="op">&lt;-</span> <span class="fu">check_if_theta_in_ci</span><span class="op">(</span><span class="va">x_0</span>, <span class="va">mat_ci_gmwm_2_step_beta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># define vector of estimated parameters as object</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">fit_mle</span>, <span class="va">fit_gmwm_1_step</span>,</span>
<span>    <span class="va">fit_gmwm_2_step</span>,</span>
<span>    <span class="va">inside_ci_mle</span>,</span>
<span>    <span class="va">inside_ci_gmwm_1</span>, <span class="va">inside_ci_gmwm_2</span>,</span>
<span>    <span class="va">fit_simu_b_mle</span><span class="op">$</span><span class="va">estimation_time</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">fit_simu_b_gmwm_1_step</span><span class="op">$</span><span class="va">estimation_time</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">fit_simu_b_gmwm_2_step</span><span class="op">$</span><span class="va">estimation_time</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># save in matrix of results</span></span>
<span>  <span class="va">mat_results</span><span class="op">[</span><span class="va">simu_b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">res</span></span>
<span></span>
<span>  <span class="co"># print status</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Completed simulation"</span>, <span class="va">simu_b</span>, <span class="st">"\n"</span>,sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define names of mat results</span></span>
<span><span class="va">name_param_functionnal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bias"</span>, <span class="st">"trend"</span>, <span class="st">"cosU"</span>, <span class="st">"sinU"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat_results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"mle"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_mle</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"gmwm_1_step"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_gmwm_1_step</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"gmwm_2_step"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_gmwm_2_step</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"mle_inside_ci_"</span>, <span class="va">name_param_functionnal</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gmwm_1_inside_ci_"</span>, <span class="va">name_param_functionnal</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gmwm_2_inside_ci_"</span>, <span class="va">name_param_functionnal</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time_mle"</span>, <span class="st">"time_gmwm_1"</span>, <span class="st">"time_gmwm_2"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Davide Antonio Cucci, Lionel Voirol, Stéphane Guerrier.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
